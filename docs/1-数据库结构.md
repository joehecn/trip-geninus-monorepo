# 1-数据库结构

```bash
docker run b
```

本文档详细描述了所有数据库表（Models）和枚举（Enums）的结构。

---

## 枚举类型 (Enums)

### CategoryType
分类类型枚举

| 值 | 说明 |
|---|---|
| `CAT_ATTRACTION` | 景点分类 |
| `CAT_HOTEL` | 酒店分类 |
| `CAT_RESTAURANT` | 餐厅分类 |
| `CAT_SHOPPING_PLACE` | 购物场所分类 |
| `CAT_TRANSPORTATION` | 交通方式分类 |

### UserRole
用户角色枚举

| 值 | 说明 |
|---|---|
| `ADMIN` | 系统管理员 |
| `PLANNER` | 计划调度员 |
| `GUIDE` | 导游 |
| `USER` | 普通用户 |

### IdCardType
证件类型枚举

| 值 | 说明 |
|---|---|
| `ID_CARD` | 身份证 |
| `PASSPORT` | 护照 |
| `HOME_RETURN_PERMIT` | 港澳回乡证 |
| `TAIWAN_COMPATRIOT_PERMIT` | 台胞证 |
| `OFFICER_ID` | 军官证 |
| `OTHER` | 其它 |

### Gender
性别枚举

| 值 | 说明 |
|---|---|
| `MALE` | 男 |
| `FEMALE` | 女 |
| `OTHER` | 其他 |

### UploaderType
上传者类型枚举

| 值 | 说明 |
|---|---|
| `USER` | 用户 |
| `PARTICIPANT` | 参与者 |

### FavoriteEntityType
收藏实体类型枚举

| 值 | 说明 |
|---|---|
| `FAV_ATTRACTION` | 收藏景点 |
| `FAV_HOTEL` | 收藏酒店 |
| `FAV_RESTAURANT` | 收藏餐厅 |
| `FAV_SHOPPING_PLACE` | 收藏购物场所 |
| `FAV_TRANSPORTATION` | 收藏交通方式 |

### MediaType
媒体类型枚举

| 值 | 说明 |
|---|---|
| `IMAGE` | 图片 |
| `VIDEO` | 视频 |

### TourGroupStatus
旅行团状态枚举

| 值 | 说明 |
|---|---|
| `DRAFT` | 草稿 |
| `CONFIRMED` | 已确认 |
| `ACTIVE` | 进行中 |
| `COMPLETED` | 已完成 |
| `CANCELLED` | 已取消 |
| `INACTIVE` | 未激活 |

### TourReviewTargetType
旅行评价对象类型枚举

| 值 | 说明 |
|---|---|
| `TOUR_GROUP` | 整体旅行体验 |
| `GUIDE` | 旅行中的特定导游 |
| `HOTEL` | 旅行中入住的酒店 |
| `ATTRACTION` | 旅行中参观的景点 |
| `RESTAURANT` | 旅行中用餐的餐厅 |
| `TRANSPORTATION` | 特定的交通路段 |
| `SHOPPING_PLACE` | 旅行中访问的购物场所 |
| `ITINERARY_PLANNING` | 行程规划体验 |
| `CUSTOMER_SUPPORT` | 客户支持服务 |
| `APP_USABILITY` | 应用的可用性 |
| `OTHER_FEEDBACK` | 一般性或其他反馈 |

### ItineraryItemType
行程条目类型枚举

| 值 | 说明 |
|---|---|
| `TRANSPORTATION` | 交通 |
| `DINING` | 餐饮 |
| `ATTRACTION` | 景点 |
| `ACCOMMODATION` | 酒店住宿 |
| `SHOPPING` | 购物 |
| `OTHER` | 其它活动 |

### GuideRole
导游角色枚举

| 值 | 说明 |
|---|---|
| `LEAD_GUIDE` | 首席导游 |
| `LOCAL_GUIDE` | 本地导游 |
| `INTERPRETER` | 翻译 |
| `DRIVER` | 司机 |

### GuideLogType
导游日志类型枚举

| 值 | 说明 |
|---|---|
| `DAILY_LOG` | 每日日志 |
| `ACTIVITY_LOG` | 活动日志 |
| `INCIDENT_LOG` | 事件日志 |
| `WEATHER_LOG` | 天气日志 |
| `FINANCIAL_LOG` | 财务日志 |

### AuditStatus
审计状态枚举

| 值 | 说明 |
|---|---|
| `SUCCESS` | 成功 |
| `FAILED` | 失败 |

---

## 数据表 (Tables)

### locations

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `city` | `String` | `@db.VarChar(100)` | 城市 |
| `region` | `String?` | `@db.VarChar(100)` | 地区/省份 |
| `country` | `String` | `@db.VarChar(100)` | 国家 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |

### attractions

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `name` | `String` | `@unique` `@db.VarChar(255)` | 景点名称 |
| `description` | `String?` | `@db.Text` | 景点描述 |
| `address` | `String` | `@db.VarChar(511)` | 地址 |
| `phone` | `String?` | `@db.VarChar(30)` | 联系电话 |
| `latitude` | `Decimal?` | `@db.Decimal(9, 6)` | 纬度 |
| `longitude` | `Decimal?` | `@db.Decimal(9, 6)` | 经度 |
| `averageRating` | `Decimal` | `@default(0.00)` | 平均评分 |
| `reviewCount` | `Int` | `@default(0)` | 评论数量 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `locationId` | `Int` | `FK` -> `locations` | 位置ID |

### categories

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `name` | `String` | `@db.VarChar(100)` | 分类名称 |
| `type` | `CategoryType` | | 分类类型 |
| `description` | `String?` | `@db.Text` | 分类描述 |

### attraction_categories

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `attractionId` | `Int` | `PK`, `FK` -> `attractions` | 景点ID |
| `categoryId` | `Int` | `PK`, `FK` -> `categories` | 分类ID |

### hotel_categories

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `hotelId` | `Int` | `PK`, `FK` -> `hotels` | 酒店ID |
| `categoryId` | `Int` | `PK`, `FK` -> `categories` | 分类ID |

### restaurant_categories

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `restaurantId` | `Int` | `PK`, `FK` -> `restaurants` | 餐厅ID |
| `categoryId` | `Int` | `PK`, `FK` -> `categories` | 分类ID |

### shopping_place_categories

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `shoppingPlaceId` | `Int` | `PK`, `FK` -> `shopping_places` | 购物场所ID |
| `categoryId` | `Int` | `PK`, `FK` -> `categories` | 分类ID |

### transportation_categories

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `transportationId` | `Int` | `PK`, `FK` -> `transportations` | 交通方式ID |
| `categoryId` | `Int` | `PK`, `FK` -> `categories` | 分类ID |

### users

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `fullName` | `String?` | `@db.VarChar(100)` | 全名 |
| `role` | `UserRole` | `@default(USER)` | 用户角色 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `openid` | `String?` | `@unique` `@db.VarChar(255)` | 微信唯一标识 |
| `idCardType` | `IdCardType` | | 证件类型 |
| `idCardNumber` | `String` | `@unique` `@db.VarChar(255)` | 证件号码 |
| `gender` | `Gender?` | | 性别 |
| `dateOfBirth` | `DateTime?` | `@db.Date` | 出生日期 |
| `phone` | `String?` | `@db.VarChar(30)` | 手机号 |

### user_favorites

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `userId` | `Int` | `FK` -> `users` | 用户ID |
| `entityType` | `FavoriteEntityType` | | 实体类型 |
| `attractionId` | `Int?` | `FK` -> `attractions` | 景点ID |
| `hotelId` | `Int?` | `FK` -> `hotels` | 酒店ID |
| `restaurantId` | `Int?` | `FK` -> `restaurants` | 餐厅ID |
| `shoppingPlaceId` | `Int?` | `FK` -> `shopping_places` | 购物场所ID |
| `transportationId` | `Int?` | `FK` -> `transportations` | 交通方式ID |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |

### assets

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `mediaType` | `MediaType` | | 媒体类型 |
| `url` | `String` | `@db.VarChar(2048)` | 资源URL |
| `caption` | `String?` | `@db.Text` | 描述 |
| `isPrimary` | `Boolean` | `@default(false)` | 是否为主图 |
| `uploadedAt` | `DateTime` | `@default(now())` | 上传时间 |
| `uploaderId` | `Int` | `FK` -> `users` | 上传者ID |
| `attractionId` | `Int?` | `FK` -> `attractions` | 景点ID |
| `hotelId` | `Int?` | `FK` -> `hotels` | 酒店ID |
| `restaurantId` | `Int?` | `FK` -> `restaurants` | 餐厅ID |
| `shoppingPlaceId` | `Int?` | `FK` -> `shopping_places` | 购物场所ID |

### hotels

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `name` | `String` | `@unique` `@db.VarChar(255)` | 酒店名称 |
| `description` | `String?` | `@db.Text` | 酒店描述 |
| `address` | `String` | `@db.VarChar(511)` | 地址 |
| `phone` | `String?` | `@db.VarChar(30)` | 联系电话 |
| `latitude` | `Decimal?` | `@db.Decimal(9, 6)` | 纬度 |
| `longitude` | `Decimal?` | `@db.Decimal(9, 6)` | 经度 |
| `starRating` | `Int` | `@default(0)` | 星级 |
| `averageRating` | `Decimal` | `@default(0.00)` | 平均评分 |
| `reviewCount` | `Int` | `@default(0)` | 评论数量 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `locationId` | `Int` | `FK` -> `locations` | 位置ID |

### hotel_rooms

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `roomType` | `String` | `@db.VarChar(100)` | 房间类型 |
| `description` | `String?` | `@db.Text` | 房间描述 |
| `isAvailable` | `Boolean` | `@default(true)` | 是否可用 |
| `maxOccupancy` | `Int` | `@default(2)` | 最大入住人数 |
| `hotelId` | `Int` | `FK` -> `hotels` | 酒店ID |

### amenities

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `name` | `String` | `@unique` `@db.VarChar(100)` | 设施名称 |
| `description` | `String?` | `@db.Text` | 设施描述 |

### hotel_amenities

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `hotelId` | `Int` | `PK`, `FK` -> `hotels` | 酒店ID |
| `amenityId` | `Int` | `PK`, `FK` -> `amenities` | 设施ID |

### tour_groups

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `name` | `String` | `@db.VarChar(255)` | 旅行团名称 |
| `description` | `String?` | `@db.Text` | 旅行团描述 |
| `startDate` | `DateTime` | `@db.Date` | 开始日期 |
| `endDate` | `DateTime` | `@db.Date` | 结束日期 |
| `maxParticipants` | `Int` | | 最大参与人数 |
| `status` | `TourGroupStatus` | `@default(ACTIVE)` | 旅行团状态 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `userId` | `Int` | `FK` -> `users` | 组织者ID |

### tour_group_participants

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `fullName` | `String` | `@db.VarChar(255)` | 全名 |
| `phone` | `String?` | `@db.VarChar(30)` | 手机号 |
| `dateOfBirth` | `DateTime?` | `@db.Date` | 出生日期 |
| `emergencyContact` | `String` | `@db.VarChar(255)` | 紧急联系人 |
| `emergencyPhone` | `String` | `@db.VarChar(30)` | 紧急联系人电话 |
| `specialRequests` | `String?` | `@db.Text` | 特殊要求 |
| `registrationDate` | `DateTime` | `@default(now())` | 注册日期 |
| `tourGroupId` | `Int` | `FK` -> `tour_groups` | 所属旅行团ID |
| `userId` | `Int` | `FK` -> `users` | 关联用户ID |
| `assignedRoomId` | `Int?` | `FK` -> `assigned_rooms` | 分配的房间ID |

### tour_group_photos

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `url` | `String` | `@db.VarChar(2048)` | 照片URL |
| `caption` | `String?` | `@db.Text` | 描述 |
| `isPublic` | `Boolean` | `@default(true)` | 是否公开 |
| `uploadDate` | `DateTime` | `@default(now())` | 上传日期 |
| `likes` | `Int` | `@default(0)` | 点赞数 |
| `tourGroupId` | `Int` | `FK` -> `tour_groups` | 所属旅行团ID |
| `uploaderType` | `UploaderType` | | 上传者类型 |
| `uploaderId` | `Int` | | 上传者ID |

### tour_reviews

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `comment` | `String?` | `@db.Text` | 评论内容 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `participantId` | `Int` | `FK` -> `tour_group_participants` | 评价作者ID |
| `tourGroupId` | `Int` | `FK` -> `tour_groups` | 所属旅行团ID |
| `targetType` | `TourReviewTargetType` | | 被评价对象类型 |
| `targetId` | `Int?` | | 被评价对象ID |
| `ratings` | `Json` | | 多维度评分 |

### tour_group_guides

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `fullName` | `String` | `@db.VarChar(255)` | 全名 |
| `phone` | `String` | `@db.VarChar(30)` | 电话 |
| `licenseNumber` | `String` | `@unique` `@db.VarChar(100)` | 导游资质编号 |
| `yearsOfExperience` | `Int?` | | 经验年限 |
| `specialty` | `String?` | `@db.Text` | 专业领域 |
| `introduction` | `String?` | `@db.Text` | 介绍 |
| `userId` | `Int` | `@unique`, `FK` -> `users` | 关联用户ID |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |

### tour_group_guide_assignments

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `assignedAt` | `DateTime` | `@default(now())` | 分配时间 |
| `role` | `GuideRole` | `@default(LEAD_GUIDE)` | 导游角色 |
| `tourGroupId` | `Int` | `FK` -> `tour_groups` | 旅行团ID |
| `guideId` | `Int` | `FK` -> `tour_group_guides` | 导游ID |

### tour_group_guide_logs

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `title` | `String` | `@db.VarChar(255)` | 标题 |
| `content` | `String` | `@db.Text` | 内容 |
| `logType` | `GuideLogType` | `@default(DAILY_LOG)` | 日志类型 |
| `date` | `DateTime` | `@db.Date` | 日期 |
| `startTime` | `DateTime?` | `@db.Time` | 开始时间 |
| `endTime` | `DateTime?` | `@db.Time` | 结束时间 |
| `locationId` | `Int?` | `FK` -> `locations` | 关联地点ID |
| `weather` | `String?` | `@db.VarChar(100)` | 天气 |
| `participantsCount` | `Int?` | | 参与人数 |
| `issues` | `String?` | `@db.Text` | 问题 |
| `solutions` | `String?` | `@db.Text` | 解决方案 |
| `nextDayPlan` | `String?` | `@db.Text` | 次日计划 |
| `isImportant` | `Boolean` | `@default(false)` | 是否重要 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `tourGroupId` | `Int` | `FK` -> `tour_groups` | 旅行团ID |

### itinerary_hotel_stays

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `checkInDate` | `DateTime` | `@db.Date` | 入住日期 |
| `checkOutDate` | `DateTime` | `@db.Date` | 退房日期 |
| `notes` | `String?` | `@db.Text` | 备注 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `destinationId` | `Int` | `@unique`, `FK` -> `itinerary_destinations` | 行程目的地ID |
| `hotelId` | `Int` | `FK` -> `hotels` | 酒店ID |

### assigned_rooms

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `roomNumber` | `String` | `@db.VarChar(50)` | 房间号 |
| `notes` | `String?` | `@db.Text` | 备注 |
| `hotelStayId` | `Int` | `FK` -> `itinerary_hotel_stays` | 酒店住宿ID |

### tour_group_participant_groups

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `name` | `String` | `@db.VarChar(100)` | 分组名称 |
| `description` | `String?` | `@db.Text` | 分组描述 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `tourGroupId` | `Int` | `FK` -> `tour_groups` | 所属旅行团ID |

### tour_group_participant_group_members

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `groupId` | `Int` | `PK`, `FK` -> `tour_group_participant_groups` | 分组ID |
| `participantId` | `Int` | `PK`, `FK` -> `tour_group_participants` | 参与者ID |
| `joinedAt` | `DateTime` | `@default(now())` | 加入时间 |

### restaurants

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `name` | `String` | `@unique` `@db.VarChar(255)` | 餐厅名称 |
| `description` | `String?` | `@db.Text` | 餐厅描述 |
| `address` | `String` | `@db.VarChar(511)` | 地址 |
| `latitude` | `Decimal?` | `@db.Decimal(9, 6)` | 纬度 |
| `longitude` | `Decimal?` | `@db.Decimal(9, 6)` | 经度 |
| `averageRating` | `Decimal` | `@default(0.00)` | 平均评分 |
| `reviewCount` | `Int` | `@default(0)` | 评论数量 |
| `priceRange` | `String?` | `@db.VarChar(50)` | 价格范围 |
| `phone` | `String?` | `@db.VarChar(30)` | 电话 |
| `website` | `String?` | `@db.VarChar(255)` | 网站 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `locationId` | `Int` | `FK` -> `locations` | 位置ID |

### transportations

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `name` | `String` | `@db.VarChar(255)` | 交通方式名称 |
| `description` | `String?` | `@db.Text` | 描述 |
| `provider` | `String?` | `@db.VarChar(255)` | 服务提供商 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |

### shopping_places

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `name` | `String` | `@unique` `@db.VarChar(255)` | 购物场所名称 |
| `description` | `String?` | `@db.Text` | 描述 |
| `address` | `String` | `@db.VarChar(511)` | 地址 |
| `latitude` | `Decimal?` | `@db.Decimal(9, 6)` | 纬度 |
| `longitude` | `Decimal?` | `@db.Decimal(9, 6)` | 经度 |
| `averageRating` | `Decimal` | `@default(0.00)` | 平均评分 |
| `reviewCount` | `Int` | `@default(0)` | 评论数量 |
| `openingHours` | `String?` | `@db.VarChar(255)` | 营业时间 |
| `phone` | `String?` | `@db.VarChar(30)` | 电话 |
| `website` | `String?` | `@db.VarChar(255)` | 网站 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `locationId` | `Int` | `FK` -> `locations` | 位置ID |

### itinerary_templates

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `title` | `String` | `@db.VarChar(255)` | 模板标题 |
| `description` | `String?` | `@db.Text` | 模板描述 |
| `durationDays` | `Int` | | 持续天数 |
| `isPublic` | `Boolean` | `@default(false)` | 是否公开 |
| `version` | `String` | `@default("1.0")` | 版本号 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `creatorId` | `Int` | `FK` -> `users` | 创建者ID |

### itineraries

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `title` | `String` | `@db.VarChar(255)` | 行程标题 |
| `description` | `String?` | `@db.Text` | 行程描述 |
| `durationDays` | `Int` | | 持续天数 |
| `startDate` | `DateTime?` | `@db.Date` | 开始日期 |
| `endDate` | `DateTime?` | `@db.Date` | 结束日期 |
| `templateVersion` | `String?` | `@db.VarChar(20)` | 模板版本号 |
| `createdAt` | `DateTime` | `@default(now())` | 创建时间 |
| `updatedAt` | `DateTime` | `@updatedAt` | 更新时间 |
| `templateId` | `Int?` | `FK` -> `itinerary_templates` | 来源模板ID |
| `tourGroupId` | `Int` | `@unique`, `FK` -> `tour_groups` | 关联旅行团ID |

### itinerary_days

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `dayNumber` | `Int` | | 天数编号 |
| `date` | `DateTime?` | `@db.Date` | 日期 |
| `notes` | `String?` | `@db.Text` | 备注 |
| `itineraryId` | `Int` | `FK` -> `itineraries` | 所属行程ID |
| `locationId` | `Int?` | `FK` -> `locations` | 当天主要地点ID |

### itinerary_destinations

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `orderInDay` | `Int` | `@default(1)` | 当天活动排序 |
| `description` | `String?` | `@db.Text` | 描述 |
| `startTime` | `DateTime?` | `@db.Time` | 开始时间 |
| `endTime` | `DateTime?` | `@db.Time` | 结束时间 |
| `notes` | `String?` | `@db.Text` | 备注 |
| `isCustomized` | `Boolean` | `@default(false)` | 是否自定义 |
| `itineraryDayId` | `Int` | `FK` -> `itinerary_days` | 所属行程天数ID |
| `itemType` | `ItineraryItemType` | | 行程条目类型 |
| `attractionId` | `Int?` | `FK` -> `attractions` | 景点ID |
| `hotelId` | `Int?` | `FK` -> `hotels` | 酒店ID |
| `restaurantId` | `Int?` | `FK` -> `restaurants` | 餐厅ID |
| `transportationId` | `Int?` | `FK` -> `transportations` | 交通方式ID |
| `shoppingPlaceId` | `Int?` | `FK` -> `shopping_places` | 购物场所ID |

### template_destinations

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `dayNumber` | `Int` | | 天数编号 |
| `orderInDay` | `Int` | `@default(1)` | 当天活动排序 |
| `description` | `String?` | `@db.Text` | 描述 |
| `notes` | `String?` | `@db.Text` | 备注 |
| `itemType` | `ItineraryItemType` | | 行程条目类型 |
| `templateId` | `Int` | `FK` -> `itinerary_templates` | 所属模板ID |
| `attractionId` | `Int?` | `FK` -> `attractions` | 景点ID |
| `hotelId` | `Int?` | `FK` -> `hotels` | 酒店ID |
| `restaurantId` | `Int?` | `FK` -> `restaurants` | 餐厅ID |
| `transportationId` | `Int?` | `FK` -> `transportations` | 交通方式ID |
| `shoppingPlaceId` | `Int?` | `FK` -> `shopping_places` | 购物场所ID |

### itinerary_day_weather_snapshots

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `date` | `DateTime` | `@db.Date` | 预报日期 |
| `temperatureHigh` | `Decimal?` | `@db.Decimal(5, 2)` | 最高温度 |
| `temperatureLow` | `Decimal?` | `@db.Decimal(5, 2)` | 最低温度 |
| `condition` | `String` | `@db.VarChar(100)` | 天气状况 |
| `humidity` | `Int?` | | 湿度百分比 |
| `windSpeed` | `Decimal?` | `@db.Decimal(5, 2)` | 风速 |
| `windDirection` | `String?` | `@db.VarChar(50)` | 风向 |
| `precipitation` | `Decimal?` | `@db.Decimal(5, 2)` | 降水量 |
| `uvIndex` | `Int?` | | 紫外线指数 |
| `sunrise` | `DateTime?` | `@db.Time` | 日出时间 |
| `sunset` | `DateTime?` | `@db.Time` | 日落时间 |
| `forecastSource` | `String?` | `@db.VarChar(100)` | 天气预报来源 |
| `capturedAt` | `DateTime` | `@default(now())` | 快照捕获时间 |
| `itineraryDayId` | `Int` | `@unique`, `FK` -> `itinerary_days` | 关联行程天数ID |
| `locationId` | `Int?` | `FK` -> `locations` | 地理位置ID |

### audit_logs

| 字段名 | 数据类型 | 约束/关系 | 说明 |
|---|---|---|---|
| `id` | `Int` | `@id` `@default(autoincrement())` | 主键 |
| `action` | `String` | `@db.VarChar(100)` | 操作类型 |
| `entityType` | `String` | `@db.VarChar(100)` | 实体类型 |
| `entityId` | `Int` | | 实体ID |
| `oldData` | `Json?` | | 旧数据 |
| `newData` | `Json?` | | 新数据 |
| `performedAt` | `DateTime` | `@default(now())` | 操作时间 |
| `ipAddress` | `String?` | `@db.VarChar(45)` | IP地址 |
| `userAgent` | `String?` | `@db.Text` | 用户代理 |
| `status` | `AuditStatus` | `@default(SUCCESS)` | 操作状态 |
| `reason` | `String?` | `@db.Text` | 操作原因 |
| `performedById` | `Int` | `FK` -> `users` | 操作者ID |